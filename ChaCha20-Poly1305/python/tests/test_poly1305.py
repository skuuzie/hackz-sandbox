import Poly1305

"""
Test vectors based on RFC 8439 (ChaCha20 and Poly1305 for IETF Protocols)
https://datatracker.ietf.org/doc/html/rfc8439#appendix-A.3
"""

def test_vector1():
    key = b'\x00' * 32
    msg = b'\x00' * 64

    mac = Poly1305.poly1305_mac(msg, key)

    assert mac == b'\x00' * 16

def test_vector2():
    key = bytes.fromhex('0000000000000000000000000000000036e5f6b5c5e06070f0efca96227a863e')
    msg = bytes.fromhex('416e79207375626d697373696f6e20746f20746865204945544620696e74656e6465642062792074686520436f6e7472696275746f7220666f72207075626c69636174696f6e20617320616c6c206f722070617274206f6620616e204945544620496e7465726e65742d4472616674206f722052464320616e6420616e792073746174656d656e74206d6164652077697468696e2074686520636f6e74657874206f6620616e204945544620616374697669747920697320636f6e7369646572656420616e20224945544620436f6e747269627574696f6e222e20537563682073746174656d656e747320696e636c756465206f72616c2073746174656d656e747320696e20494554462073657373696f6e732c2061732077656c6c206173207772697474656e20616e6420656c656374726f6e696320636f6d6d756e69636174696f6e73206d61646520617420616e792074696d65206f7220706c6163652c207768696368206172652061646472657373656420746f')

    mac = Poly1305.poly1305_mac(msg, key)

    assert mac == bytes.fromhex('36e5f6b5c5e06070f0efca96227a863e')

def test_vector3():
    key = bytes.fromhex('36e5f6b5c5e06070f0efca96227a863e00000000000000000000000000000000')
    msg = bytes.fromhex('416e79207375626d697373696f6e20746f20746865204945544620696e74656e6465642062792074686520436f6e7472696275746f7220666f72207075626c69636174696f6e20617320616c6c206f722070617274206f6620616e204945544620496e7465726e65742d4472616674206f722052464320616e6420616e792073746174656d656e74206d6164652077697468696e2074686520636f6e74657874206f6620616e204945544620616374697669747920697320636f6e7369646572656420616e20224945544620436f6e747269627574696f6e222e20537563682073746174656d656e747320696e636c756465206f72616c2073746174656d656e747320696e20494554462073657373696f6e732c2061732077656c6c206173207772697474656e20616e6420656c656374726f6e696320636f6d6d756e69636174696f6e73206d61646520617420616e792074696d65206f7220706c6163652c207768696368206172652061646472657373656420746f')

    mac = Poly1305.poly1305_mac(msg, key)

    assert mac == bytes.fromhex('f3477e7cd95417af89a6b8794c310cf0')